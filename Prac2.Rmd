---
title: "Titanic PRA2: Limpieza y análisis de datos"
author: "María Angeles Fuentes Expósito, Norberto Jesús de la Cruz Falcón"
date: '`r format(Sys.Date(),"%e de %B, %Y")`'
output:
  pdf_document:
    toc: yes
  html_document:
    toc: yes
##bibliography: dataclean.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# dplyr
if (!require('dplyr')) install.packages('dplyr')
library(dplyr)
# ggplot
if (!require('ggplot2')) install.packages('ggplot2')
library(ggplot2)

red_col <- "#cc4533"
```

## 1. Descripción del dataset. ¿Por qué es importante y qué pregunta/problema pretende responder?

El dataset está formado por las siguientes variables:
- PassengerId: Número identificador del pasajero.
- Survived: Variable dicotómica que indica si el pasajero sobrevivió al naufragio del Titanic o no.
- Pclass: Clase a la que pertenecía el pasajero.
- Name: Nombre y apellidos del pasajero.
- Sex: Género del pasajero.
- Age: Edad del pasajero.
- SibSp: Número de hermanos o de cónyuges que tenía el pasajero a bordo.
- Parch: Número de hijos o padres que tenía el pasajero a bordo.
- Ticket: Número identificador del ticket.
- Fare: Tarifa del billete del pasajero en libras esterlinas.
- Cabin: Cabina asignada al pasajero.
- Embarked: Puerto en el que embarcó el pasajero.

## 2. Integración y selección de los datos de interés a analizar. Puede ser el resultado de adicionar diferentes datasets o una subselección útil de los datos originales, en base al objetivo que se quiera conseguir.

Cargamos el conjunto de datos y observamos que está formado por 891 registros y las 12 variables comentadas en el apartado anterior.
```{r}
df <- read.csv('train.csv')
dim(df)
```
```{r}
head(df)
```

Las variables *Name* y *Ticket* no serán de utilidad para los análisis estadísticos por lo que las eliminaremos.
```{r}
df <- df %>% select(-c(Name, Ticket))
head(df)
```

## 3. Limpieza de los datos.

### 3.1 Valores perdidos.
Observamos que la variable *Age* tiene 177 valores nulos. Eliminamos los registros con valores nulos en esta variable.
```{r}
summary(df)
```
```{r}
df <- na.omit(df,Age)
summary(df)
```
En la variable *Survived* no se observan valores pérdidos.
```{r}
levels(as.factor(df$Survived))
```
Tampoco se observan valores pérdidos en la variable Pclass. La variable Pclass únicamente toma los valores 1, 2 y 3.

```{r}
levels(as.factor(df$Pclass))
```
La variable *Sex* toma sólo dos valores *male* y *female* por lo que no existen valores pérdidos.
```{r}
ggplot(data=df, mapping=aes(Sex)) + geom_bar(fill=red_col) + ggtitle("Distribución de la variable sexo") + theme(plot.title = element_text(hjust = 0.5))
```
Tampoco se observan valores pérdidos en la variable *Parch* ni en la variable *SibSp*.

```{r}
ggplot(data=df, mapping=aes(Parch)) + geom_bar(fill=red_col) + ggtitle("Distribución del número de hijos o padres en el barco") + theme(plot.title = element_text(hjust = 0.5))
```

```{r}
ggplot(data=df, mapping=aes(SibSp)) + geom_bar(fill=red_col) + ggtitle("Distribución del número de hermanoso cónyuges en el barco") + theme(plot.title = element_text(hjust = 0.5))
```
Por el contrario, existen valores vacíos en la variable *Cabin*. En concreto, más de la mitad de los registros tienen valores vacíos en la variable *Cabin* (529 de 891). Por ello, eliminaremos la variable *Cabin*.

```{r}
nrow(df %>% filter(Cabin == ""))
```

```{r}
df <- df %>% select(-Cabin)
head(df)
```
```{r}
dim(df)
```

Por último se encuentran dos registros con valores pérdidos en la variable *Embarked*. Se eliminan estos dos registros.
```{r}
table(as.factor(df$Embarked))
```

```{r}
df <- df %>% filter(Embarked != "")
dim(df)
```

### 3.2 Identificación y gestión de los valores extremos.

## 4. Análisis de los datos

### 4.1. Selección de los grupos de datos que se quieren analizar/comparar (p. e., si se van a comparar grupos de datos, ¿cuáles son estos grupos y qué tipo de análisis se van a aplicar?)

### 4.2. Comprobación de la normalidad y homogeneidad de la varianza.

### 4.3. Aplicación de pruebas estadísticas para comparar los grupos de datos. En función de los datos y el objetivo del estudio, aplicar pruebas de contraste de hipótesis, correlaciones, regresiones, etc. Aplicar al menos tres métodos de análisis diferentes.

## 5. Representación de los resultados a partir de tablas y gráficas. Este apartado se puede responder a lo largo de la práctica, sin necesidad de concentrar todas las representaciones en este punto de la práctica.

## 6. Resolución del problema. A partir de los resultados obtenidos, ¿cuáles son las conclusiones? ¿Los resultados permiten responder al problema? 

